input CohortChartConfigChart {
    property: String
    type: CohortChartType
}

enum CohortChartType {
    count
    percentage
}

type GS_About {
    page: String
    title: String
    type: String
    text: [String]
}

type GlobalSearchResult {
    about_count: Int
    about_page: [GS_About]
}

type IdsListsES {
    associatedIds: [AssociatedId]
    participantIds: [String]
}

type AssociatedId {
    participant_id: String
    associated_id: String
}

type ParticipantResult {
    participant_id: String
    study_id: String
}

type SearchParticipantsReturnObject {
    group: String
    subjects: Float
}

type NestedParticipant {
    id: String
    participant_id: String
    race: [String]
    sex_at_birth: String
}

type CohortMetadataReturnObject {
    id: String
    participant_id: String
    race: [String]
    sex_at_birth: String

    # CPI Data
    diagnoses: [DiagnosisOverviewResult]
    genetic_analyses: [GeneticAnalysisOverviewResult]
    survivals: [SurvivalOverviewResult]
    synonyms: [NestedSynonym]
    treatments: [TreatmentOverviewResult]
    treatment_responses: [TreatmentResponseOverviewResult]
}

type CohortMetadataConsentGroup {
    # Consent Group data
    consent_group_name: String
    consent_group_number: String

    # Participant data
    participants: [CohortMetadataReturnObject]
}

type CpiDataReturnObject {
    associated_id: String
    data_location: String
    data_type: String
    domain_category: String
    domain_description: String
    repository_of_synonym_id: String
}

type NestedSynonym {
    associated_id: String
    data_location: String
    domain_category: String
    domain_description: String
    repository_of_synonym_id: String
}

type RangeCount {
    lowerBound: Int
    upperBound: Int
    subjects: Int
}

type GetParticipantsResult {
    # Overall count
    numberOfParticipants: Int
    numberOfDiagnoses: Int
    numberOfDiseases: Int
    numberOfGeneticAnalyses: Int
    numberOfStudies: Int
    numberOfSurvivals: Int
    numberOfTreatments: Int
    numberOfTreatmentResponses: Int

    # Recommended maximum page size
    pageSize: Int

    # Demographics
    filterParticipantCountByRace: [SearchParticipantsReturnObject]
    filterParticipantCountBySexAtBirth: [SearchParticipantsReturnObject]

    # Diagnoses
    filterParticipantCountByAgeAtDiagnosis: RangeCount
    filterParticipantCountByAnatomicSite: [SearchParticipantsReturnObject]
    filterParticipantCountByDiagnosis: [SearchParticipantsReturnObject]
    filterParticipantCountByDiagnosisClassificationSystem: [SearchParticipantsReturnObject]
    filterParticipantCountByDiagnosisBasis: [SearchParticipantsReturnObject]
    filterParticipantCountByDiseasePhase: [SearchParticipantsReturnObject]

    # Genetic Analyses
    filterParticipantCountByAlteration: [SearchParticipantsReturnObject]
    filterParticipantCountByAlterationType: [SearchParticipantsReturnObject]
    filterParticipantCountByFusionPartnerGene: [SearchParticipantsReturnObject]
    filterParticipantCountByGeneSymbol: [SearchParticipantsReturnObject]
    filterParticipantCountByReportedSignificance: [SearchParticipantsReturnObject]
    filterParticipantCountByReportedSignificanceSystem: [SearchParticipantsReturnObject]
    filterParticipantCountByStatus: [SearchParticipantsReturnObject]

    # Studies
    filterParticipantCountByDbgapAccession: [SearchParticipantsReturnObject]
    filterParticipantCountByStudyName: [SearchParticipantsReturnObject]

    # Survivals
    filterParticipantCountByAgeAtLastKnownSurvivalStatus: RangeCount
    filterParticipantCountByCauseOfDeath: [SearchParticipantsReturnObject]
    filterParticipantCountByFirstEvent: [SearchParticipantsReturnObject]
    filterParticipantCountByLastKnownSurvivalStatus: [SearchParticipantsReturnObject]

    # Treatments
    filterParticipantCountByAgeAtTreatmentStart: RangeCount
    filterParticipantCountByAgeAtTreatmentEnd: RangeCount
    filterParticipantCountByTreatmentType: [SearchParticipantsReturnObject]
    filterParticipantCountByTreatmentAgent: [SearchParticipantsReturnObject]

    # Treatment Responses
    filterParticipantCountByResponse: [SearchParticipantsReturnObject]
    filterParticipantCountByAgeAtResponse: RangeCount
    filterParticipantCountByResponseCategory: [SearchParticipantsReturnObject]
    filterParticipantCountByResponseSystem: [SearchParticipantsReturnObject]

    # Widget counts
    participantCountByRace: [SearchParticipantsReturnObject]
    participantCountBySexAtBirth: [SearchParticipantsReturnObject]
    participantCountByAgeAtDiagnosis: [SearchParticipantsReturnObject]
    participantCountByAnatomicSite: [SearchParticipantsReturnObject]
    participantCountByDiagnosis: [SearchParticipantsReturnObject]
    participantCountByTreatmentType: [SearchParticipantsReturnObject]
}

type ParticipantOverviewResult {
    # Demographics
    id: String # For adding to cohort
    participant_id: String # For display
    race: [String]
    sex_at_birth: String

    # CPI Data
    cpi_data: [CpiDataReturnObject]

    # Study
    dbgap_accession: String

    # Additional fields for download
    study_id: String
}

type CohortChartsResult {
    property: String
    cohorts: [CohortChartReturnObject]
}

type KMPlotResult {
    id: String # Participant ID
    time: Int # Difference between highest age_at_last_known_survival_status and highest age_at_diagnosis
    event: Int # Event (0 = censored, 1 = event occurred)
    group: String # Name of cohort
}

type RiskTableResult {
    cohorts: [RiskTableReturnObject]
    timeIntervals: [String]
}

type RiskTableReturnObject {
    cohort: String
    survivalData: [SearchParticipantsReturnObject]
}

type CohortChartReturnObject {
    cohort: String
    participantsByGroup: [SearchParticipantsReturnObject]
}

type CohortMetadataResult {
    # Study
    dbgap_accession: String

    consent_groups: [CohortMetadataConsentGroup]
}

type DiagnosisOverviewResult {
    # Demographics
    participant: NestedParticipant

    # Diagnosis
    id: String # For selecting record
    age_at_diagnosis: String
    anatomic_site: String
    diagnosis_basis: [String]
    diagnosis: String
    diagnosis_classification_system: [String]
    disease_phase: String
    tumor_classification: String

    # Study
    dbgap_accession: String

    # Additional fields for Explore page download
    diagnosis_id: String
    diagnosis_comment: String
    study_id: String
    toronto_childhood_cancer_staging: String
    tumor_grade: String
    tumor_stage_clinical_m: String
    tumor_stage_clinical_n: String
    tumor_stage_clinical_t: String
}

type GeneticAnalysisOverviewResult {
    # Study
    dbgap_accession: String

    # Demographics
    participant: NestedParticipant

    # Genetic Analysis
    id: String # For selecting record
    genetic_analysis_id: String
    alteration: String
    cytoband: String
    gene_symbol: [String]
    genomic_source_category: String
    hgvs_coding: String
    hgvs_genome: String
    hgvs_protein: String
    status: String
    test: String
    reported_significance: String
    reported_significance_system: String

    # Additional properties for download
    alteration_effect: String
    alteration_type: String
    chromosome: String
    exon: String
    fusion_partner_exon: String
    fusion_partner_gene: String
    reference_genome: String
}

type StudyOverviewResult {
    # Study
    id: String # For selecting record
    dbgap_accession: String
    study_name: String

    # Additional fields for download
    external_url: String
    study_description: String
    study_id: String
}

type SurvivalOverviewResult {
    # Demographics
    participant: NestedParticipant

    # Study
    dbgap_accession: String

    # Survival
    id: String # For selecting record
    age_at_last_known_survival_status: String
    cause_of_death: String
    first_event: String
    last_known_survival_status: String

    # Additional fields for download
    age_at_event_free_survival_status: String
    event_free_survival_status: String
    study_id: String
    survival_id: String
}

type TreatmentOverviewResult {
    # Demographics
    participant: NestedParticipant

    # Study
    dbgap_accession: String
    study_id: String

    # Treatment
    id: String # For selecting record
    treatment_id: String
    age_at_treatment_start: String
    age_at_treatment_end: String
    treatment_type: String
    treatment_agent: [String]
}

type TreatmentResponseOverviewResult {
    # Demographics
    participant: NestedParticipant

    # Study
    dbgap_accession: String
    study_id: String

    # Treatment Response
    id: String # For selecting record
    treatment_response_id: String
    response: String
    age_at_response: String
    response_category: String
    response_system: String
}

type StudyDetailsResult {
    dbgap_accession: String
    study_description: String
    num_participants: Int
    num_diseases: Int
    num_anatomic_sites: Int
    num_survivals: Int
}

type StudiesListingResult {
    num_diseases: Int
    num_participants: Int
    dbgap_accession: String
    study_name: String
}

schema {
    query: QueryType
}

type QueryType {
    esVersion: String
    findParticipantIdsInList(participant_id: [String] = []): [ParticipantResult]
    globalSearch(input: String, first: Int = 10, offset: Int = 0): GlobalSearchResult

    # cpi_batch_size and use_cache are used for debugging purposes. The frontend may omit them just fine
    idsLists(cpi_batch_size: Int = 2500, use_cache: Boolean = true): IdsListsES
    
    numberOfDiseases: Int
    numberOfParticipants: Int
    numberOfStudies: Int
    numberOfSurvivals: Int
    numberOfTreatments: Int
    numberOfTreatmentResponses: Int

    cohortCharts(
        c1: [String],
        c2: [String],
        c3: [String],
        charts: [CohortChartConfigChart]
    ): [CohortChartsResult]

    kMPlot(
        c1: [String],
        c2: [String],
        c3: [String]
    ): [KMPlotResult]

    riskTableData(
        c1: [String]!,
        c2: [String]!,
        c3: [String]!
    ): RiskTableResult

    cohortMetadata(
        # Demographics
        participant_pk: [String]

        # Table config
        first: Int = 10,
        offset: Int = 0,
        order_by: String = "",
        sort_direction: String = ""
    ): [CohortMetadataResult]

    getParticipants(
        # Demographics
        participant_pk: [String]
        participant_id: [String] = [""],
        race: [String] = [""],
        sex_at_birth: [String] = [""],

        # Diagnoses
        age_at_diagnosis: [Int] = [0],
        age_at_diagnosis_unknownAges: [String] = [""],
        anatomic_site: [String] = [""],
        diagnosis: [String] = [""],
        diagnosis_classification_system: [String] = [""],
        diagnosis_basis: [String] = [""],
        disease_phase: [String] = [""]

        # Genetic Analyses
        alteration: [String] = [""],
        alteration_type: [String] = [""],
        fusion_partner_gene: [String] = [""],
        gene_symbol: [String] = [""],
        reported_significance: [String] = [""],
        reported_significance_system: [String] = [""],
        status: [String] = [""]

        # Studies
        dbgap_accession: [String] = [""],
        study_name: [String] = [""],

        # Survivals
        age_at_last_known_survival_status: [Int] = [0],
        age_at_last_known_survival_status_unknownAges: [String] = [""],
        cause_of_death: [String] = [""],
        first_event: [String] = [""],
        last_known_survival_status: [String] = [""]

        # Treatments
        age_at_treatment_start: [Int] = [0],
        age_at_treatment_start_unknownAges: [String] = [""],
        age_at_treatment_end: [Int] = [0],
        age_at_treatment_end_unknownAges: [String] = [""],
        treatment_type: [String] = [""],
        treatment_agent: [String] = [""],

        # Treatment Responses
        response: [String] = [""],
        age_at_response: [Int] = [0],
        age_at_response_unknownAges: [String] = [""],
        response_category: [String] = [""],
        response_system: [String] = [""]
    ): GetParticipantsResult

    participantOverview(
        # Demographics
        participant_pk: [String]
        participant_id: [String] = [""],
        race: [String] = [""],
        sex_at_birth: [String] = [""],

        # Diagnoses
        age_at_diagnosis: [Int] = [0],
        age_at_diagnosis_unknownAges: [String] = [""],
        anatomic_site: [String] = [""],
        diagnosis: [String] = [""],
        diagnosis_classification_system: [String] = [""],
        diagnosis_basis: [String] = [""],
        disease_phase: [String] = [""]

        # Genetic Analyses
        alteration: [String] = [""],
        alteration_type: [String] = [""],
        fusion_partner_gene: [String] = [""],
        gene_symbol: [String] = [""],
        reported_significance: [String] = [""],
        reported_significance_system: [String] = [""],
        status: [String] = [""]

        # Studies
        dbgap_accession: [String] = [""],
        study_name: [String] = [""],

        # Survivals
        age_at_last_known_survival_status: [Int] = [0],
        age_at_last_known_survival_status_unknownAges: [String] = [""],
        cause_of_death: [String] = [""],
        first_event: [String] = [""],
        last_known_survival_status: [String] = [""]

        # Treatments
        age_at_treatment_start: [Int] = [0],
        age_at_treatment_start_unknownAges: [String] = [""],
        age_at_treatment_end: [Int] = [0],
        age_at_treatment_end_unknownAges: [String] = [""],
        treatment_type: [String] = [""],
        treatment_agent: [String] = [""],

        # Treatment Responses
        response: [String] = [""],
        age_at_response: [Int] = [0],
        age_at_response_unknownAges: [String] = [""],
        response_category: [String] = [""],
        response_system: [String] = [""]

        # Table config
        first: Int = 10,
        offset: Int = 0,
        order_by: String = "",
        sort_direction: String = ""
    ): [ParticipantOverviewResult]

    diagnosisOverview(
        # Demographics
        participant_pk: [String]
        participant_id: [String] = [""],
        race: [String] = [""],
        sex_at_birth: [String] = [""],

        # Diagnoses
        age_at_diagnosis: [Int] = [0],
        age_at_diagnosis_unknownAges: [String] = [""],
        anatomic_site: [String] = [""],
        diagnosis: [String] = [""],
        diagnosis_classification_system: [String] = [""],
        diagnosis_basis: [String] = [""],
        disease_phase: [String] = [""]

        # Genetic Analyses
        alteration: [String] = [""],
        alteration_type: [String] = [""],
        fusion_partner_gene: [String] = [""],
        gene_symbol: [String] = [""],
        reported_significance: [String] = [""],
        reported_significance_system: [String] = [""],
        status: [String] = [""]

        # Studies
        dbgap_accession: [String] = [""],
        study_name: [String] = [""],

        # Survivals
        age_at_last_known_survival_status: [Int] = [0],
        age_at_last_known_survival_status_unknownAges: [String] = [""],
        cause_of_death: [String] = [""],
        first_event: [String] = [""],
        last_known_survival_status: [String] = [""]

        # Treatments
        age_at_treatment_start: [Int] = [0],
        age_at_treatment_start_unknownAges: [String] = [""],
        age_at_treatment_end: [Int] = [0],
        age_at_treatment_end_unknownAges: [String] = [""],
        treatment_type: [String] = [""],
        treatment_agent: [String] = [""],

        # Treatment Responses
        response: [String] = [""],
        age_at_response: [Int] = [0],
        age_at_response_unknownAges: [String] = [""],
        response_category: [String] = [""],
        response_system: [String] = [""]

        # Table config
        first: Int = 10,
        offset: Int = 0,
        order_by: String = "",
        sort_direction: String = ""
    ): [DiagnosisOverviewResult]
    
    geneticAnalysisOverview(
        # Demographics
        participant_pk: [String]
        participant_id: [String] = [""],
        race: [String] = [""],
        sex_at_birth: [String] = [""],

        # Diagnoses
        age_at_diagnosis: [Int] = [0],
        age_at_diagnosis_unknownAges: [String] = [""],
        anatomic_site: [String] = [""],
        diagnosis: [String] = [""],
        diagnosis_classification_system: [String] = [""],
        diagnosis_basis: [String] = [""],
        disease_phase: [String] = [""]

        # Genetic Analyses
        alteration: [String] = [""],
        alteration_type: [String] = [""],
        fusion_partner_gene: [String] = [""],
        gene_symbol: [String] = [""],
        reported_significance: [String] = [""],
        reported_significance_system: [String] = [""],
        status: [String] = [""]

        # Studies
        dbgap_accession: [String] = [""],
        study_name: [String] = [""],

        # Survivals
        age_at_last_known_survival_status: [Int] = [0],
        age_at_last_known_survival_status_unknownAges: [String] = [""],
        cause_of_death: [String] = [""],
        first_event: [String] = [""],
        last_known_survival_status: [String] = [""]

        # Treatments
        age_at_treatment_start: [Int] = [0],
        age_at_treatment_start_unknownAges: [String] = [""],
        age_at_treatment_end: [Int] = [0],
        age_at_treatment_end_unknownAges: [String] = [""],
        treatment_type: [String] = [""],
        treatment_agent: [String] = [""],

        # Treatment Responses
        response: [String] = [""],
        age_at_response: [Int] = [0],
        age_at_response_unknownAges: [String] = [""],
        response_category: [String] = [""],
        response_system: [String] = [""]

        # Table config
        first: Int = 10,
        offset: Int = 0,
        order_by: String = "",
        sort_direction: String = ""
    ): [GeneticAnalysisOverviewResult]

    studyOverview(
        # Demographics
        participant_pk: [String]
        participant_id: [String] = [""],
        race: [String] = [""],
        sex_at_birth: [String] = [""],

        # Diagnoses
        age_at_diagnosis: [Int] = [0],
        age_at_diagnosis_unknownAges: [String] = [""],
        anatomic_site: [String] = [""],
        diagnosis: [String] = [""],
        diagnosis_classification_system: [String] = [""],
        diagnosis_basis: [String] = [""],
        disease_phase: [String] = [""]

        # Genetic Analyses
        alteration: [String] = [""],
        alteration_type: [String] = [""],
        fusion_partner_gene: [String] = [""],
        gene_symbol: [String] = [""],
        reported_significance: [String] = [""],
        reported_significance_system: [String] = [""],
        status: [String] = [""]

        # Studies
        dbgap_accession: [String] = [""],
        study_name: [String] = [""],

        # Survivals
        age_at_last_known_survival_status: [Int] = [0],
        age_at_last_known_survival_status_unknownAges: [String] = [""],
        cause_of_death: [String] = [""],
        first_event: [String] = [""],
        last_known_survival_status: [String] = [""]

        # Treatments
        age_at_treatment_start: [Int] = [0],
        age_at_treatment_start_unknownAges: [String] = [""],
        age_at_treatment_end: [Int] = [0],
        age_at_treatment_end_unknownAges: [String] = [""],
        treatment_type: [String] = [""],
        treatment_agent: [String] = [""],

        # Treatment Responses
        response: [String] = [""],
        age_at_response: [Int] = [0],
        age_at_response_unknownAges: [String] = [""],
        response_category: [String] = [""],
        response_system: [String] = [""]

        # Table config
        first: Int = 10,
        offset: Int = 0,
        order_by: String = "",
        sort_direction: String = ""
    ): [StudyOverviewResult]

    survivalOverview(
        # Demographics
        participant_pk: [String]
        participant_id: [String] = [""],
        race: [String] = [""],
        sex_at_birth: [String] = [""],

        # Diagnoses
        age_at_diagnosis: [Int] = [0],
        age_at_diagnosis_unknownAges: [String] = [""],
        anatomic_site: [String] = [""],
        diagnosis: [String] = [""],
        diagnosis_classification_system: [String] = [""],
        diagnosis_basis: [String] = [""],
        disease_phase: [String] = [""]

        # Genetic Analyses
        alteration: [String] = [""],
        alteration_type: [String] = [""],
        fusion_partner_gene: [String] = [""],
        gene_symbol: [String] = [""],
        reported_significance: [String] = [""],
        reported_significance_system: [String] = [""],
        status: [String] = [""]

        # Studies
        dbgap_accession: [String] = [""],
        study_name: [String] = [""],

        # Survivals
        age_at_last_known_survival_status: [Int] = [0],
        age_at_last_known_survival_status_unknownAges: [String] = [""],
        cause_of_death: [String] = [""],
        first_event: [String] = [""],
        last_known_survival_status: [String] = [""]

        # Treatments
        age_at_treatment_start: [Int] = [0],
        age_at_treatment_start_unknownAges: [String] = [""],
        age_at_treatment_end: [Int] = [0],
        age_at_treatment_end_unknownAges: [String] = [""],
        treatment_type: [String] = [""],
        treatment_agent: [String] = [""],

        # Treatment Responses
        response: [String] = [""],
        age_at_response: [Int] = [0],
        age_at_response_unknownAges: [String] = [""],
        response_category: [String] = [""],
        response_system: [String] = [""]

        # Table config
        first: Int = 10,
        offset: Int = 0,
        order_by: String = "",
        sort_direction: String = ""
    ): [SurvivalOverviewResult]

    treatmentOverview(
        # Demographics
        participant_pk: [String]
        participant_id: [String] = [""],
        race: [String] = [""],
        sex_at_birth: [String] = [""],

        # Diagnoses
        age_at_diagnosis: [Int] = [0],
        age_at_diagnosis_unknownAges: [String] = [""],
        anatomic_site: [String] = [""],
        diagnosis: [String] = [""],
        diagnosis_classification_system: [String] = [""],
        diagnosis_basis: [String] = [""],
        disease_phase: [String] = [""]

        # Genetic Analyses
        alteration: [String] = [""],
        alteration_type: [String] = [""],
        fusion_partner_gene: [String] = [""],
        gene_symbol: [String] = [""],
        reported_significance: [String] = [""],
        reported_significance_system: [String] = [""],
        status: [String] = [""]

        # Studies
        dbgap_accession: [String] = [""],
        study_name: [String] = [""],

        # Survivals
        age_at_last_known_survival_status: [Int] = [0],
        age_at_last_known_survival_status_unknownAges: [String] = [""],
        cause_of_death: [String] = [""],
        first_event: [String] = [""],
        last_known_survival_status: [String] = [""]

        # Treatments
        age_at_treatment_start: [Int] = [0],
        age_at_treatment_start_unknownAges: [String] = [""],
        age_at_treatment_end: [Int] = [0],
        age_at_treatment_end_unknownAges: [String] = [""],
        treatment_type: [String] = [""],
        treatment_agent: [String] = [""],

        # Treatment Responses
        response: [String] = [""],
        age_at_response: [Int] = [0],
        age_at_response_unknownAges: [String] = [""],
        response_category: [String] = [""],
        response_system: [String] = [""]

        # Table config
        first: Int = 10,
        offset: Int = 0,
        order_by: String = "",
        sort_direction: String = ""
    ): [TreatmentOverviewResult]

    treatmentResponseOverview(
        # Demographics
        participant_pk: [String]
        participant_id: [String] = [""],
        race: [String] = [""],
        sex_at_birth: [String] = [""],

        # Diagnoses
        age_at_diagnosis: [Int] = [0],
        age_at_diagnosis_unknownAges: [String] = [""],
        anatomic_site: [String] = [""],
        diagnosis: [String] = [""],
        diagnosis_classification_system: [String] = [""],
        diagnosis_basis: [String] = [""],
        disease_phase: [String] = [""]

        # Genetic Analyses
        alteration: [String] = [""],
        alteration_type: [String] = [""],
        fusion_partner_gene: [String] = [""],
        gene_symbol: [String] = [""],
        reported_significance: [String] = [""],
        reported_significance_system: [String] = [""],
        status: [String] = [""]

        # Studies
        dbgap_accession: [String] = [""],
        study_name: [String] = [""],

        # Survivals
        age_at_last_known_survival_status: [Int] = [0],
        age_at_last_known_survival_status_unknownAges: [String] = [""],
        cause_of_death: [String] = [""],
        first_event: [String] = [""],
        last_known_survival_status: [String] = [""]

        # Treatments
        age_at_treatment_start: [Int] = [0],
        age_at_treatment_start_unknownAges: [String] = [""],
        age_at_treatment_end: [Int] = [0],
        age_at_treatment_end_unknownAges: [String] = [""],
        treatment_type: [String] = [""],
        treatment_agent: [String] = [""],

        # Treatment Responses
        response: [String] = [""],
        age_at_response: [Int] = [0],
        age_at_response_unknownAges: [String] = [""],
        response_category: [String] = [""],
        response_system: [String] = [""]

        # Table config
        first: Int = 10,
        offset: Int = 0,
        order_by: String = "",
        sort_direction: String = ""
    ): [TreatmentResponseOverviewResult]
    
    studyDetails(study_id: String): StudyDetailsResult
    studiesListing: [StudiesListingResult]
}
